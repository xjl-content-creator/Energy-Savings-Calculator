<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Window Film Energy Savings Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .calculator-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            padding: 40px 30px;
            color: white;
            text-align: center;
        }

        .header-icon {
            font-size: 40px;
            margin-bottom: 8px;
        }

        .header h1 {
            margin: 0 0 10px 0;
            font-size: 32px;
            font-weight: 700;
        }

        .header p {
            margin: 0;
            opacity: 0.9;
            font-size: 16px;
        }

        .progress-bar-container {
            padding: 20px 30px;
            background: #f8f9fa;
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .progress-step {
            font-size: 14px;
            font-weight: 400;
            color: #999;
        }

        .progress-step.active {
            font-weight: 600;
            color: #1e3c72;
        }

        .progress-bar {
            height: 6px;
            background: #e0e0e0;
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s ease;
        }

        .content {
            padding: 40px 30px;
            min-height: 400px;
        }

        .step {
            display: none;
        }

        .step.active {
            display: block;
        }

        h2 {
            margin-top: 0;
            color: #1e3c72;
            font-size: 24px;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
        }

        .options-grid {
            display: grid;
            gap: 12px;
        }

        .option-button {
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
            font-size: 16px;
            font-family: inherit;
        }

        .option-button:hover {
            border-color: #667eea;
        }

        .option-button.selected {
            border: 3px solid #667eea;
            background: #f0f4ff;
        }

        .option-button strong {
            color: #1e3c72;
        }

        .form-group {
            margin-bottom: 30px;
        }

        .form-label {
            display: block;
            margin-bottom: 12px;
            font-weight: 600;
            color: #333;
        }

        .form-input {
            width: 100%;
            padding: 16px;
            font-size: 18px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-family: inherit;
        }

        .form-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .slider-container {
            margin-bottom: 12px;
        }

        .range-slider {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: #e0e0e0;
            border-radius: 4px;
            outline: none;
        }

        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: #667eea;
            border-radius: 50%;
            cursor: pointer;
        }

        .range-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: #667eea;
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        .range-labels {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: #666;
        }

        .preview-box {
            margin-top: 16px;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #e0e0e0;
            text-align: center;
            font-weight: 600;
        }

        .button-group {
            display: flex;
            gap: 12px;
            margin-top: 30px;
        }

        .btn {
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            font-family: inherit;
            transition: all 0.3s;
        }

        .btn-primary {
            flex: 2;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .btn-secondary {
            flex: 1;
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .result-card {
            padding: 20px;
            border-radius: 12px;
        }

        .result-card.blue {
            background: #f0f9ff;
            border: 2px solid #0ea5e9;
        }

        .result-card.green {
            background: #f0fdf4;
            border: 2px solid #22c55e;
        }

        .result-card.yellow {
            background: #fef3c7;
            border: 2px solid #eab308;
        }

        .result-card-label {
            font-size: 14px;
            margin-bottom: 8px;
        }

        .result-card.blue .result-card-label {
            color: #0369a1;
        }

        .result-card.green .result-card-label {
            color: #15803d;
        }

        .result-card.yellow .result-card-label {
            color: #854d0e;
        }

        .result-card-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .result-card.blue .result-card-value {
            color: #0c4a6e;
        }

        .result-card.green .result-card-value {
            color: #14532d;
        }

        .result-card.yellow .result-card-value {
            color: #713f12;
        }

        .result-card-unit {
            font-size: 14px;
        }

        .recommended-film {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 24px;
            border-radius: 16px;
            margin-bottom: 24px;
            text-align: center;
        }

        .recommended-film-label {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .recommended-film-name {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .recommended-film-specs {
            font-size: 14px;
            opacity: 0.9;
        }

        .info-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 24px;
        }

        .info-box h3 {
            margin-top: 0;
            font-size: 18px;
            color: #333;
            margin-bottom: 16px;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
        }

        .spec-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            font-size: 14px;
        }

        .footer {
            padding: 20px 30px;
            background: #f8f9fa;
            text-align: center;
            font-size: 14px;
            color: #666;
            border-top: 1px solid #e0e0e0;
        }

        @media (max-width: 600px) {
            .results-grid,
            .spec-grid {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="calculator-container">
        <!-- Header -->
        <div class="header">
            <div class="header-icon">üè¢</div>
            <h1>Window Film Energy Calculator</h1>
            <p>Calculate your energy savings with advanced window film technology</p>
        </div>

        <!-- Progress Bar -->
        <div class="progress-bar-container">
            <div class="progress-steps">
                <div class="progress-step" id="progress-step-1">Location</div>
                <div class="progress-step" id="progress-step-2">Building</div>
                <div class="progress-step" id="progress-step-3">Preferences</div>
                <div class="progress-step" id="progress-step-4">Results</div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
        </div>

        <!-- Content -->
        <div class="content">
            <!-- Step 1: Climate -->
            <div class="step active" id="step-1">
                <h2>Select Your Climate Zone</h2>
                <p class="subtitle">Choose the climate that best matches your building location</p>
                <div class="options-grid" id="climate-options"></div>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="nextStep()" id="step-1-next" disabled>
                        Next: Building Type
                    </button>
                </div>
            </div>

            <!-- Step 2: Building & Glass -->
            <div class="step" id="step-2">
                <h2>Building & Glass Information</h2>
                
                <div class="form-group">
                    <label class="form-label">Building Type</label>
                    <div class="options-grid" id="building-options"></div>
                </div>

                <div class="form-group">
                    <label class="form-label">Current Glass Type</label>
                    <div class="options-grid" id="glass-options"></div>
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="previousStep()">Back</button>
                    <button class="btn btn-primary" onclick="nextStep()" id="step-2-next" disabled>
                        Next: Preferences
                    </button>
                </div>
            </div>

            <!-- Step 3: Preferences -->
            <div class="step" id="step-3">
                <h2>Window Details & Preferences</h2>
                
                <div class="form-group">
                    <label class="form-label">Total Window Area (m¬≤)</label>
                    <input type="number" class="form-input" id="window-area" value="100" min="1" 
                           onchange="validateStep3()">
                </div>

                <div class="form-group">
                    <label class="form-label">Desired Light Transmission: <span id="vlt-value">50</span>%</label>
                    <div class="slider-container">
                        <input type="range" class="range-slider" id="vlt-slider" 
                               min="10" max="90" value="50" oninput="updateVLTPreview()">
                    </div>
                    <div class="range-labels">
                        <span>Darker (More Privacy)</span>
                        <span>Lighter (More Daylight)</span>
                    </div>
                    <div class="preview-box" id="vlt-preview">Interior Brightness Preview</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Electricity Cost ($/kWh)</label>
                    <input type="number" class="form-input" id="electricity-cost" value="0.12" 
                           step="0.01" min="0" onchange="validateStep3()">
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="previousStep()">Back</button>
                    <button class="btn btn-primary" onclick="calculateSavings()">Calculate Savings</button>
                </div>
            </div>

            <!-- Step 4: Results -->
            <div class="step" id="step-4">
                <h2 style="text-align: center;">Your Energy Savings Report</h2>
                
                <div id="results-container"></div>

                <button class="btn btn-primary" style="width: 100%;" onclick="resetCalculator()">
                    Calculate Again
                </button>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>Note: Results are estimates based on typical conditions. Actual savings may vary.</p>
        </div>
    </div>

    <script>
        // Window Film Products - Updated with actual product data (27 products)
        const WINDOW_FILMS = [
            { id: 'tsds70-3', name: 'TSDS70-3', vlt: 70, sc: 0.50, ir_1400: 97, ir_950: 85, uvr: 99, tser: 52 },
            { id: 'tsds737-3', name: 'TSDS737-3', vlt: 72, sc: 0.52, ir_1400: 94, ir_950: 77, uvr: 99, tser: 54 },
            { id: 'tsds40-3', name: 'TSDS40-3', vlt: 36, sc: 0.37, ir_1400: 97, ir_950: 87, uvr: 99, tser: 64 },
            { id: 'tsds25-3', name: 'TSDS25-3', vlt: 24, sc: 0.36, ir_1400: 98, ir_950: 90, uvr: 99, tser: 63 },
            { id: 'tsds16-3', name: 'TSDS16-3', vlt: 16, sc: 0.33, ir_1400: 96, ir_950: 90, uvr: 99, tser: 63 },
            { id: 'tsdsc70-2', name: 'TSDSC70-2', vlt: 70, sc: 0.54, ir_1400: 93, ir_950: 76, uvr: 99, tser: 53 },
            { id: 'tsdsc50-2', name: 'TSDSC50-2', vlt: 52, sc: 0.43, ir_1400: 95, ir_950: 80, uvr: 99, tser: 60 },
            { id: 'tsdsc40-2', name: 'TSDSC40-2', vlt: 38, sc: 0.37, ir_1400: 93, ir_950: 78, uvr: 99, tser: 55 },
            { id: 'tsdsc25-2', name: 'TSDSC25-2', vlt: 26, sc: 0.36, ir_1400: 91, ir_950: 80, uvr: 99, tser: 61 },
            { id: 'tsdsc15-2', name: 'TSDSC15-2', vlt: 15, sc: 0.30, ir_1400: 98, ir_950: 90, uvr: 99, tser: 63 },
            { id: 'tsss70y', name: 'TSSS70Y', vlt: 73, sc: 0.64, ir_1400: 53, ir_950: 40, uvr: 99, tser: 35 },
            { id: 'tsss60y', name: 'TSSS60Y', vlt: 69, sc: 0.58, ir_1400: 65, ir_950: 56, uvr: 99, tser: 40 },
            { id: 'tsss60gnx', name: 'TSSS60GNX', vlt: 69, sc: 0.62, ir_1400: 57, ir_950: 46, uvr: 99, tser: 36 },
            { id: 'tsss60x', name: 'TSSS60X', vlt: 73, sc: 0.69, ir_1400: 48, ir_950: 39, uvr: 99, tser: 35 },
            { id: 'tszr75', name: 'TSZR75', vlt: 75, sc: 0.60, ir_1400: 94, ir_950: 90, uvr: 99, tser: 47 },
            { id: 'tszrjs70', name: 'TSZRJS70', vlt: 70, sc: 0.54, ir_1400: 93, ir_950: 77, uvr: 99, tser: 61 },
            { id: 'tszrys70', name: 'TSZRYS70', vlt: 66, sc: 0.54, ir_1400: 93, ir_950: 84, uvr: 99, tser: 53 },
            { id: 'tszr35', name: 'TSZR35', vlt: 35, sc: 0.47, ir_1400: 94, ir_950: 92, uvr: 99, tser: 59 },
            { id: 'tszr18', name: 'TSZR18', vlt: 18, sc: 0.42, ir_1400: 94, ir_950: 94, uvr: 99, tser: 63 },
            { id: 'tstns60', name: 'TSTNS60', vlt: 66, sc: 0.55, ir_1400: 99, ir_950: 96, uvr: 99, tser: 52 },
            { id: 'tstns35', name: 'TSTNS35', vlt: 38, sc: 0.48, ir_1400: 99, ir_950: 96, uvr: 99, tser: 59 },
            { id: 'tstns18', name: 'TSTNS18', vlt: 18, sc: 0.42, ir_1400: 99, ir_950: 97, uvr: 99, tser: 64 },
            { id: 'tstns10', name: 'TSTNS10', vlt: 9, sc: 0.40, ir_1400: 99, ir_950: 98, uvr: 99, tser: 65 },
            { id: 'tstnc70', name: 'TSTNC70', vlt: 75, sc: 0.60, ir_1400: 98, ir_950: 95, uvr: 99, tser: 48 },
            { id: 'tstnc35', name: 'TSTNC35', vlt: 35, sc: 0.47, ir_1400: 99, ir_950: 97, uvr: 99, tser: 59 },
            { id: 'tstnc18', name: 'TSTNC18', vlt: 18, sc: 0.42, ir_1400: 99, ir_950: 97, uvr: 99, tser: 63 },
            { id: 'tstnc10', name: 'TSTNC10', vlt: 10, sc: 0.40, ir_1400: 99, ir_950: 98, uvr: 99, tser: 65 }
        ];

        const CLIMATE_DATA = {
            'hot-humid': { name: 'Hot & Humid (Southeast Asia, Gulf Coast)', cdd: 3500, hdd: 500, solar: 5.5, cooling_dominant: true },
            'hot-dry': { name: 'Hot & Arid (Middle East, Southwest US)', cdd: 4000, hdd: 800, solar: 6.5, cooling_dominant: true },
            'temperate': { name: 'Temperate (Europe, East Coast US)', cdd: 1200, hdd: 3000, solar: 4.0, cooling_dominant: false },
            'cold': { name: 'Cold (Northern Europe, Canada)', cdd: 400, hdd: 5000, solar: 3.0, cooling_dominant: false },
            'tropical': { name: 'Tropical (Equatorial Regions)', cdd: 4500, hdd: 0, solar: 5.8, cooling_dominant: true }
        };

        const BUILDING_TYPES = {
            'residential': { name: 'Residential Home', hvac_efficiency: 0.75, window_ratio: 0.15, usage_hours: 24 },
            'office': { name: 'Office Building', hvac_efficiency: 0.80, window_ratio: 0.35, usage_hours: 12 },
            'retail': { name: 'Retail/Commercial', hvac_efficiency: 0.78, window_ratio: 0.25, usage_hours: 14 },
            'school': { name: 'School/Educational', hvac_efficiency: 0.76, window_ratio: 0.20, usage_hours: 8 },
            'warehouse': { name: 'Warehouse/Industrial', hvac_efficiency: 0.70, window_ratio: 0.10, usage_hours: 10 }
        };

        const GLASS_TYPES = {
            'single': { name: 'Single Pane Clear', u_value: 5.8, shgc: 0.86 },
            'double': { name: 'Double Pane Clear', u_value: 2.8, shgc: 0.76 },
            'double-lowE': { name: 'Double Pane Low-E', u_value: 1.8, shgc: 0.60 },
            'tinted': { name: 'Tinted Glass', u_value: 5.5, shgc: 0.65 }
        };

        // State
        let currentStep = 1;
        let inputs = {
            climate: '',
            buildingType: '',
            glassType: '',
            windowArea: 100,
            desiredVLT: 50,
            electricityCost: 0.12
        };

        // Initialize
        function init() {
            renderClimateOptions();
            renderBuildingOptions();
            renderGlassOptions();
            updateVLTPreview();
            updateProgress();
        }

        function renderClimateOptions() {
            const container = document.getElementById('climate-options');
            container.innerHTML = Object.entries(CLIMATE_DATA).map(([key, data]) => `
                <button class="option-button" onclick="selectClimate('${key}')">
                    <strong>${data.name}</strong>
                </button>
            `).join('');
        }

        function renderBuildingOptions() {
            const container = document.getElementById('building-options');
            container.innerHTML = Object.entries(BUILDING_TYPES).map(([key, data]) => `
                <button class="option-button" onclick="selectBuilding('${key}')">
                    ${data.name}
                </button>
            `).join('');
        }

        function renderGlassOptions() {
            const container = document.getElementById('glass-options');
            container.innerHTML = Object.entries(GLASS_TYPES).map(([key, data]) => `
                <button class="option-button" onclick="selectGlass('${key}')">
                    ${data.name}
                </button>
            `).join('');
        }

        function selectClimate(key) {
            inputs.climate = key;
            document.querySelectorAll('#climate-options .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.closest('.option-button').classList.add('selected');
            document.getElementById('step-1-next').disabled = false;
        }

        function selectBuilding(key) {
            inputs.buildingType = key;
            document.querySelectorAll('#building-options .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.closest('.option-button').classList.add('selected');
            validateStep2();
        }

        function selectGlass(key) {
            inputs.glassType = key;
            document.querySelectorAll('#glass-options .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.closest('.option-button').classList.add('selected');
            validateStep2();
        }

        function validateStep2() {
            document.getElementById('step-2-next').disabled = !(inputs.buildingType && inputs.glassType);
        }

        function validateStep3() {
            inputs.windowArea = parseFloat(document.getElementById('window-area').value) || 100;
            inputs.electricityCost = parseFloat(document.getElementById('electricity-cost').value) || 0.12;
        }

        function updateVLTPreview() {
            const vlt = parseInt(document.getElementById('vlt-slider').value);
            inputs.desiredVLT = vlt;
            document.getElementById('vlt-value').textContent = vlt;
            
            const preview = document.getElementById('vlt-preview');
            const darkness = 0.9 - vlt/100;
            preview.style.background = `linear-gradient(to right, rgba(0,0,0,${darkness}), rgba(255,255,255,${vlt/100}))`;
            preview.style.color = vlt > 50 ? '#333' : 'white';
        }

        function nextStep() {
            if (currentStep < 4) {
                currentStep++;
                showStep(currentStep);
            }
        }

        function previousStep() {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
            }
        }

        function showStep(step) {
            document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
            document.getElementById(`step-${step}`).classList.add('active');
            updateProgress();
        }

        function updateProgress() {
            const progressFill = document.getElementById('progress-fill');
            progressFill.style.width = `${(currentStep / 4) * 100}%`;
            
            for (let i = 1; i <= 4; i++) {
                const stepEl = document.getElementById(`progress-step-${i}`);
                if (i <= currentStep) {
                    stepEl.classList.add('active');
                } else {
                    stepEl.classList.remove('active');
                }
            }
        }

        function calculateSavings() {
            validateStep3();
            
            const climate = CLIMATE_DATA[inputs.climate];
            const building = BUILDING_TYPES[inputs.buildingType];
            const glass = GLASS_TYPES[inputs.glassType];
            
            // Find recommended film based on desired VLT
            const recommendedFilm = WINDOW_FILMS.reduce((prev, curr) => 
                Math.abs(curr.vlt - inputs.desiredVLT) < Math.abs(prev.vlt - inputs.desiredVLT) ? curr : prev
            );

            // Calculate SHGC
            const shgc_with_film = glass.shgc * recommendedFilm.sc;
            const shgc_reduction = glass.shgc - shgc_with_film;

            // Calculate U-value
            const u_value_improvement = glass.u_value * 0.12;
            const u_value_with_film = glass.u_value - u_value_improvement;

            // Cooling savings
            const cooling_hours = climate.cdd * 24;
            const solar_gain_reduction = inputs.windowArea * shgc_reduction * climate.solar * (cooling_hours / 8760);
            const cooling_energy_saved = solar_gain_reduction / building.hvac_efficiency;

            // Heating savings
            const heating_energy_saved = inputs.windowArea * u_value_improvement * climate.hdd * 24 * 0.024 / building.hvac_efficiency;

            // Totals
            const total_energy_saved = cooling_energy_saved + heating_energy_saved;
            const peak_load_reduction = inputs.windowArea * shgc_reduction * 1.0;
            const annual_cost_savings = total_energy_saved * inputs.electricityCost;
            const co2_reduction = total_energy_saved * 0.5;
            const energy_per_sqm = total_energy_saved / inputs.windowArea;

            // Display results
            displayResults({
                recommendedFilm,
                totalEnergySaved: Math.round(total_energy_saved),
                coolingEnergySaved: Math.round(cooling_energy_saved),
                heatingEnergySaved: Math.round(heating_energy_saved),
                energyPerSqm: Math.round(energy_per_sqm * 10) / 10,
                annualCostSavings: Math.round(annual_cost_savings),
                co2Reduction: Math.round(co2_reduction),
                peakLoadReduction: Math.round(peak_load_reduction * 10) / 10,
                shgcBefore: Math.round(glass.shgc * 100),
                shgcAfter: Math.round(shgc_with_film * 100),
                uValueBefore: Math.round(glass.u_value * 10) / 10,
                uValueAfter: Math.round(u_value_with_film * 10) / 10
            });

            currentStep = 4;
            showStep(4);
        }

        function displayResults(results) {
            const container = document.getElementById('results-container');
            container.innerHTML = `
                <div class="recommended-film">
                    <div class="recommended-film-label">Recommended Product</div>
                    <div class="recommended-film-name">${results.recommendedFilm.name}</div>
                    <div class="recommended-film-specs">
                        VLT: ${results.recommendedFilm.vlt}% | TSER: ${results.recommendedFilm.tser}%
                    </div>
                </div>

                <div class="results-grid">
                    <div class="result-card blue">
                        <div class="result-card-label">Annual Energy Savings</div>
                        <div class="result-card-value">${results.totalEnergySaved.toLocaleString()}</div>
                        <div class="result-card-label">kWh/year</div>
                    </div>
                    <div class="result-card green">
                        <div class="result-card-label">Annual Cost Savings</div>
                        <div class="result-card-value">$${results.annualCostSavings.toLocaleString()}</div>
                        <div class="result-card-label">per year</div>
                    </div>
                    <div class="result-card yellow">
                        <div class="result-card-label">Energy per m¬≤</div>
                        <div class="result-card-value">${results.energyPerSqm}</div>
                        <div class="result-card-label">kWh/m¬≤/year</div>
                    </div>
                    <div class="result-card green">
                        <div class="result-card-label">CO‚ÇÇ Reduction</div>
                        <div class="result-card-value">${results.co2Reduction.toLocaleString()}</div>
                        <div class="result-card-label">kg CO‚ÇÇ/year</div>
                    </div>
                </div>

                <div class="info-box">
                    <h3>Energy Breakdown</h3>
                    <div class="info-row">
                        <span>Cooling Energy Saved:</span>
                        <strong>${results.coolingEnergySaved.toLocaleString()} kWh</strong>
                    </div>
                    <div class="info-row">
                        <span>Heating Energy Saved:</span>
                        <strong>${results.heatingEnergySaved.toLocaleString()} kWh</strong>
                    </div>
                    <div class="info-row">
                        <span>Peak Load Reduction:</span>
                        <strong>${results.peakLoadReduction} kW</strong>
                    </div>
                </div>

                <div class="info-box">
                    <h3>Window Performance Improvements</h3>
                    <div class="info-row">
                        <span>Solar Heat Gain (SHGC):</span>
                        <span>${results.shgcBefore}% ‚Üí <strong style="color: #10b981;">${results.shgcAfter}%</strong></span>
                    </div>
                    <div class="info-row">
                        <span>U-Value (W/m¬≤K):</span>
                        <span>${results.uValueBefore} ‚Üí <strong style="color: #10b981;">${results.uValueAfter}</strong></span>
                    </div>
                </div>

                <div class="info-box">
                    <h3>Film Specifications</h3>
                    <div class="spec-grid">
                        <div>Visible Light Transmission: <strong>${results.recommendedFilm.vlt}%</strong></div>
                        <div>Shading Coefficient: <strong>${results.recommendedFilm.sc}</strong></div>
                        <div>IR Rejection (1400nm): <strong>${results.recommendedFilm.ir_1400}%</strong></div>
                        <div>IR Rejection (950nm): <strong>${results.recommendedFilm.ir_950}%</strong></div>
                        <div>UV Rejection: <strong>${results.recommendedFilm.uvr}%</strong></div>
                        <div>Total Solar Energy Rejection: <strong>${results.recommendedFilm.tser}%</strong></div>
                    </div>
                </div>
            `;
        }

        function resetCalculator() {
            currentStep = 1;
            inputs = {
                climate: '',
                buildingType: '',
                glassType: '',
                windowArea: 100,
                desiredVLT: 50,
                electricityCost: 0.12
            };
            document.getElementById('window-area').value = 100;
            document.getElementById('vlt-slider').value = 50;
            document.getElementById('electricity-cost').value = 0.12;
            document.getElementById('step-1-next').disabled = true;
            document.querySelectorAll('.option-button').forEach(btn => btn.classList.remove('selected'));
            updateVLTPreview();
            showStep(1);
        }

        // Initialize on load
        init();
    </script>
</body>
</html>
